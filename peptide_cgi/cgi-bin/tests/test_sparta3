#! /bin/csh -f

# Tests visualization of SPARTA-calculated theoretical deltashifts
# (NMR-STAR 2.1 file).

set result = 0

rm -f */16385*

echo -n "Processing NMR-STAR: "
./s2d -file test_data/sd16385.str -name 16385 -force -check_res_list \
  -check_pct -sparta_file test_data/bmr16385_sparta.str
if ($status != 0) then
  echo "First invocation of s2d failed!"
  set result = 1
endif

source tests/test_sparta3_check

#TEMP? (until SPARTA output is fixed)
set file = "data_dir/16385sd1.dat"
set line = '^1 1 2 GLU -0.286 -1.14 0.09 0.731 0.0 0.0$'
source tests/check4line
set line = '^1 1 107 LEU 0.242 -1.544 -1.754 0.886 -0.059 -0.457$'
source tests/check4line
set line = '^1 20 2 GLU -0.143 -1.812 -0.099 0.943 0.0 0.0$'
source tests/check4line
set line = '^1 20 107 LEU -0.08 -0.42 1.02 0.144 1.538 0.054$'
source tests/check4line
set line = '^1 0 2 GLU -0.245 -1.449 0.202 0.053 0.0 0.0$'
source tests/check4line
set line = '^1 0 107 LEU -0.031 0.038 0.022 0.675 0.875 -0.095$'
source tests/check4line


echo -n "Test_sparta3 result: "
if ($result == 0) then
  echo "OK"
  exit 0
else
  echo "FAILED"
  exit 1
endif
