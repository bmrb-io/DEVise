#! /bin/csh -f

#  ========================================================================
#  DEVise Data Visualization Software
#  (c) Copyright 2001-2010
#  By the DEVise Development Group
#  Madison, Wisconsin
#  All Rights Reserved.
#  ========================================================================
#
#  Under no circumstances is this software to be copied, distributed,
#  or altered in any way without prior permission from the DEVise
#  Development Group.

############################################################

#  Set the modes of the files generated by s2d (there doesn't seem
#  to be a way to do this directly in Java).

############################################################

#  $Id$

############################################################

if ($#argv == 2) then
  set name = $1
  set is_uvd = $2
else
  echo "Usage: set_modes <name> <is_uvd>"
  exit
endif

set outfile = "tmp/set_modes.out"
if (-e $outfile) then
  rm $outfile
endif
echo set_modes arguments: $* > $outfile

if ($is_uvd) then
  set sess_dir = "session_dir/.uvd"
  set data_dir = "data_dir/uvd"
  set html_dir = "html_dir/uvd"
else
  set sess_dir = "session_dir"
  set data_dir = "data_dir"
  set html_dir = "html_dir"
endif

# Make sure the session file directory has correct permissions, since
# Java creates directories with 644 permissions(!).
if (-e $sess_dir/$name) then
  chmod 755 $sess_dir/$name >>& outfile
  chmod 644 $sess_dir/$name/$name* $data_dir/$name* >>& outfile
endif
if (-e session_dir/vis_server/$name) then
  chmod 755 session_dir/vis_server/$name >>& outfile
  chmod 644 session_dir/vis_server/$name/$name* \
    data_dir/vis_server/$name* >>& outfile
endif
chmod 644 $html_dir/$name* >>& outfile
